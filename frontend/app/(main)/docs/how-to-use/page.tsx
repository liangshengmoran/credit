"use client"

import { MarkdownRenderer } from "@/components/common/docs/markdown-renderer"
import { TableOfContents } from "@/components/common/docs/toc"

const CONTENT = `
# 使用指南
> 为开发者和用户提供完整的平台使用说明

## 快速开始
- 身份认证：基于 LINUX DO Connect (OAuth)
- 支付方式：账户余额支付
- 费率：动态费率，由商家承担
- 争议保护：支持买卖双方争议处理
## 角色说明
- **商户**：接入支付接口的开发者/商家
- **用户**：在商家处消费的终端用户
- **平台**：LINUX DO PAY 系统本身

# 商户接入

## 1. 创建商户应用
### 1.1 开通流程
1) 前往 [商户中心](/merchant)
2) 点击顶部右侧 **创建应用** 按钮
3) 填写必要信息：
   - 应用名称
   - 应用主页
   - 回调地址（支付完成后跳转）
   - 通知地址（异步回调通知）

### 1.2 获取 API 凭证
创建成功后，在商户中心顶部右侧选择器中选择您的应用。

在 **API 配置** 面板中获取：
- \`Client ID\`：商户客户端ID，用于标识您的身份
- \`Client Secret\`：商户客户端密钥，用于签名验证（**请妥善保管，切勿泄露**）

### 1.3 编辑应用信息
在商户中心顶部右侧选择器中选择应用，可在 **应用管理** 面板中随时编辑应用配置。

## 2. 接入方式

### 2.1 API 接口接入（推荐）
- 协议：全面兼容 **EasyPay (易支付)** 接口协议
- 文档：[API 接口文档](/docs/api)
- SDK：可直接使用现有易支付 SDK 或插件

核心流程：
\`\`\`
生成签名 → POST /pay/submit.php → 跳转收银台 → 接收 notify_url 回调
\`\`\`

### 2.2 平台在线收款
- 场景：无法进行代码开发，或只需简单收款链接
- 步骤：
  1. 在商户中心点击 **在线收款** 功能
  2. 创建在线商品收款
  3. 获取唯一支付链接
  4. 发送给需要付款的客户

### 2.3 接入 New API 站点
LINUX DO PAY 兼容 EasyPay 协议，公益站站长可直接集成。

#### 步骤一：创建商户APP
前往 [商户中心](/merchant)，点击 **创建应用**，填写 New API 站点信息：

| 字段 | 值 |
| :-- | :-- |
| 应用名称 | \`您的应用名称\` |
| 应用主页 | \`https://{您的域名}/\` |
| 回调地址 | \`https://{您的域名}/console/log\` |
| 通知地址 | \`https://{您的域名}/api/user/epay/notify\` |

#### 步骤二：前往系统设置
在 New API 站点的系统设置中找到 **支付设置**。

#### 步骤三：配置 LINUX DO PAY 支付

| 参数 | 值 |
| :-- | :-- |
| 支付地址 | \`http://pay.linux.do/epay/pay\` |
| 易支付商户ID | 您的 \`Client ID\` |
| 易支付商户密钥 | 您的 \`Client Secret\` |
| 回调地址 | \`https://{您的域名}/\` |

充值方式设置（JSON 格式）：
\`\`\`json
[
  {"color":"rgba(var(--semi-blue-5), 1)","name":"支付宝","type":"alipay"},
  {"color":"rgba(var(--semi-green-5), 1)","name":"微信","type":"wxpay"},
  {"color":"black","name":"Linux Do Pay","type":"epay"}
]
\`\`\`

# 用户支付

## 支付流程
作为消费者用户，在支持 LINUX DO PAY 的商家消费时：

1. **确认订单**
   - 在收银台页面查看订单金额（LDC）和收款方信息
   - 核对金额与商家名称是否正确

2. **支付验证**
   - 系统引导您完成支付
   - 直接使用平台账户余额进行支付

3. **支付结果**
   - **成功**：显示支付成功状态，自动跳转回商家网站
   - **失败/取消**：可以重新发起支付

4. **账单查询**
   - 在 **交易** 中查看每一笔支出的详情、状态及对应商家

# 费用体系

## 手续费规则
为维持良好的平台交易管理机制，按照行业标准收取手续费。

- **承担方**：手续费默认**由商家承担**
- **用户支付**：订单原价，不会产生额外费用
- **商家实收**：订单金额 - 手续费

计算公式：
\`\`\`
手续费 = 订单金额 × 当前费率
商家实际到账 = 订单金额 - 手续费
\`\`\`

## 动态费率
费率并非固定不变，会根据以下因素动态调整：
- 商家交易流水
- 商家信誉等级
- 平台活动

# 争议处理

我们致力于保障买卖双方的合法权益。当交易出现纠纷（如未发货、商品不符）时，可使用争议功能。

## 用户发起争议

如果您对已支付的订单有异议：

1. 进入 **交易记录** 页面
2. 找到对应订单，点击 **详情** 或 **发起争议** 图标
3. 填写争议理由（如"未收到货"），并提交

> **注意**：发起争议后，相关资金可能会被暂时冻结，直到争议解决。

## 商家处理争议

作为商家，您需要及时响应用户的争议请求：

1. 在商户中心或通知中查看到 **待处理的争议**
2. 查看用户理由，选择操作：
   - **同意退款**：认可用户诉求，资金原路退回给用户
   - **拒绝/申诉**：如果您认为已履约，请提交相关证据（如发货日志）

> **重要**：建议买卖双方优先通过沟通解决。长时间未处理的争议会由平台管理员介入仲裁，这可能会影响您的商户信誉。

# 转账功能

您可以直接向平台内的其他用户进行 LDC 转账，无需通过商户接口。

## 操作步骤
1. 进入 **交易** 页面，选择 **转账**
2. 填写收款人信息：
   - **收款人账户**：对方的用户名
   - **收款人 ID**：对方的用户ID，确保资金去向准确
   - **金额**：转账数额
3. 验证安全密码后，资金将实时到账

## 注意事项
> **重要**：请勿滥用转账系统进行交易、集资、刷号等行为，审计系统发现此类行为会立即封禁相关账户！

# 社区积分

您的 LDC 余额包含 **社区积分 (Community Balance)**。

## 基本获取方式
通过在 LINUX DO 社区的活跃行为获得：
- 发帖
- 回复
- 点赞
- 其他社区贡献

## 划转规则
- **划转时间**：社区积分每日凌晨 **00:00** 自动划转至可用余额
- **限制说明**：划转前不可用于交易或转账
- **费用**：目前划转**免手续费**

# 账户设置

您可以在 **设置 (Settings)** 页面管理您的账户。

## 功能列表
- **个人资料**：查看当前的账户信息和信任等级
- **安全设置**：修改支付密码
- **通知设置**：暂未上线
- **外观设置**：切换主题模式
`

export default function HowToUsePage() {
  return (
    <div className="container max-w-8xl mx-auto px-4 py-8 lg:px-8">
      <div className="grid grid-cols-1 lg:grid-cols-[1fr_240px] gap-10">
        <main className="min-w-0 pb-[60vh]">
          <MarkdownRenderer content={CONTENT} />
        </main>
        <aside className="hidden lg:block relative">
          <div className="sticky top-24">
            <TableOfContents content={CONTENT} />
          </div>
        </aside>
      </div>
    </div>
  )
}
